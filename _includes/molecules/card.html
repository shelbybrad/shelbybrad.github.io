{% comment %}
  Components/includes use captures for content and documentation. The 'component' area is the component proper.

  The component is rendered at the end via the 'mode' conditional.

  Please thoroughly document all components.
{% endcomment %}

{% comment %} Get a pre-made description or derive it. {% endcomment %}
{% if include.entity.meta.description %}
  {% assign entity_description=include.entity.meta.description %}
{% else %}
  {% capture entity_description %}{{ include.entity.content | strip_html | strip_newlines | replace: '  ', ' ' | truncate: 155, '' }}}{% endcapture %}
{% endif %}

{% capture component %}
  <li class="card js--child--link display--flex flex-direction--column {% if include.classes %}{{ include.classes }}{% endif %}">
    <div class="card--text padding-horizontal--4 padding-vertical--4">
      <h3 class="card--title"><a href="{{ include.entity.url }}">{{ include.entity.title }}</a></h3>
      <p class="card--description">{{ entity_description }}</p>
    </div>

    <figure class="figure figure--card--image order--neg1">
      {% if include.entity.meta.image.src %}
        <img src="{{ site.baseurl }}{{ site.subpath }}/assets/images/{{ include.entity.meta.image.src }}" alt="{{ include.entity.meta.image.alt }}" loading="lazy" />
      {% else %}
        <img src="{{ site.baseurl }}{{ site.subpath }}/assets/images/{{ site.meta.image.src }}" alt="{{ include.alt }}" loading="lazy" />
      {% endif %}
    </figure>
  </li>
{% endcapture %}

{% capture usage %}
  ## General guidance

  Cards are represent content that has its own page.

  @see https://inclusive-components.design/cards/
{% endcapture %}

{% capture accessibility %}
  Just some sample text in the accessibility section for now.

  @see https://inclusive-components.design/cards/
{% endcapture %}

{% capture props %}
  classes| css classes applied to parent| color--main-dark,
  entity| An individual item from a output collection| post
{% endcapture %}
{% assign classes = "image--polaroid, font-family--secondary" | split: ", " %}

{% comment %} "Mode conditional" for rendering. {% endcomment %}
{% if include.mode == "docblock" %}
  {% include molecules/docblock.html
    accessibility=accessibility
    classes=classes
    html=component
    props=props
    source=include
    usage=usage
  %}
{% else %}
  {{ component }}
{% endif %}
